# 三、运算符

数字运算符是一个符号，它使脚本执行特定的数学或逻辑操作。数字运算符可以分为五种类型:算术、赋值、比较、逻辑和按位运算符。

## 算术运算符

算术运算符包括四种基本算术运算，以及用于获得除法余数的模数运算符(`%`)。

```php
$x = 4 + 2; // 6, addition
$x = 4 - 2; // 2, subtraction
$x = 4 * 2; // 8, multiplication
$x = 4 / 2; // 2, division
$x = 4 % 2; // 0, modulus (division remainder)

```

PHP 5.6 中引入了一个求幂运算符(`**`)。它将左边的操作数提升到右边操作数的幂。

```php
$x = 4 ** 2; // 16, exponentiation

```

## 赋值运算符

第二组是赋值操作符，最重要的是赋值操作符(`=`)本身，它给变量赋值。

```php
$x = 1; // assignment

```

## 组合赋值运算符

赋值运算符和算术运算符的一个常见用途是对变量进行运算，然后将结果保存回同一个变量中。使用组合赋值操作符可以缩短这些操作。

```php
$x += 5; // $x = $x+5;
$x -= 5; // $x = $x-5;
$x *= 5; // $x = $x*5;
$x /= 5; // $x = $x/5;
$x %= 5; // $x = $x%5;

```

PHP 5.6 中添加的取幂运算符也接受了一个简写赋值运算符。

```php
$x **= 5; // $x = $x**5;

```

## 递增和递减运算符

另一种常见的操作是将变量加 1 或减 1。这可以用增量(`++`)和减量(`--`)操作符来简化。

```php
$x++; // $x += 1;
$x--; // $x -= 1;

```

这两个运算符都可以用在变量之前或之后。

```php
$x++; // post-increment
$x--; // post-decrement
++$x; // pre-increment
--$x; // pre-decrement

```

无论使用哪个变量，变量的结果都是相同的。区别在于后操作符在改变变量之前返回原始值，而前操作符首先改变变量，然后返回值。

```php
$x = 5; $y = $x++; // $x=6, $y=5
$x = 5; $y = ++$x; // $x=6, $y=6

```

## 比较运算符

比较运算符比较两个值并返回`true`或`false`。它们主要用于指定条件，即评估为`true`或`false`的表达式。

```php
$x = (2 == 3);  // equal to (false)
$x = (2 != 3);  // not equal to (true)
$x = (2 <> 3);  // not equal to (alternative)
$x = (2 === 3); // identical (false)
$x = (2 !== 3); // not identical (true)
$x = (2 > 3);   // false,greater than (false)
$x = (2 < 3);   // less than (true)
$x = (2 >= 3);  // greater than or equal to (false)
$x = (2 <= 3);  // less than or equal to (true)

```

严格相等运算符`===`和`!==`用于比较类型和值。这是必要的，因为常规的“等于”(`==`)和“不等于”(`!=`)运算符在比较操作数之前会自动执行类型转换。当不需要“等于”运算的类型转换功能时，使用严格比较被认为是一种好的做法。

```php
$x = (1 ==  "1"); // true (same value)
$x = (1 === "1"); // false (different types)

```

PHP 7 增加了一个新的比较操作符，叫做*飞船操作符* ( `<=>`)。它比较两个值，如果两个值相等，则返回 0；如果左边的值较大，则返回 1；如果右边的值较大，则返回–1。

```php
$x = 1 <=> 1; // 0 (1 == 1)
$x = 3 <=> 2; // 1 (3 > 2)
$x = 1 <=> 2; // -1 (1 < 2)

```

## 逻辑运算符

逻辑运算符通常与比较运算符一起使用。如果左右两边都为真，则逻辑与(`&&`)计算为`true`，如果左右两边都为真，则逻辑或(`||`)计算为`true`。对一个布尔结果求反，有一个逻辑非(`!`)运算符。请注意，对于“逻辑与”和“逻辑或”，如果左侧已经确定了结果，则不会计算运算符的右侧。

```php
$x = (true && false); // logical and (false)
$x = (true || false); // logical or (true)
$x = !true;           // logical not (false)

```

## 按位运算符

按位运算符可以处理二进制数字。例如，xor 运算符(`^`)打开运算符一侧设置的位，而不是两侧设置的位。

```php
$x = 5 & 4;  // 101&100=100 (4) // and
$x = 5 | 4;  // 101|100=101 (5) // or
$x = 5 ^ 4;  // 101¹⁰⁰=001 (1) // xor (exclusive or)
$x = 4 << 1; // 100<<1=1000 (8) // left shift
$x = 4 >> 1; // 100>>1=10   (2) // right shift
$x = ~4;     // ~00000100=11111011 (-5) // invert

```

这些位操作符有速记赋值操作符，就像算术操作符一样。

```php
$x=5; $x &= 4;  // 101&100=100 (4) // and
$x=5; $x |= 4;  // 101|100=101 (5) // or
$x=5; $x ^= 4;  // 101¹⁰⁰=001 (1) // xor
$x=5; $x <<= 1; // 101<<1=1010 (10)// left shift
$x=5; $x >>= 1; // 101>>1=10   (2) // right shift

```

请注意，与按位运算符一起使用的十进制数自动计算为二进制数。二进制记数法也可用于为按位运算指定二进制数。

```php
$x = 0b101 & 0b100; // 0b100 (4)

```

## 运算符优先级

当表达式包含多个运算符时，这些运算符的优先级决定了它们的求值顺序。优先顺序见表 3-1 。

表 3-1

运算符优先级的顺序

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"></colgroup> 
| 

在…之前

 | 

操作员

 | 

在…之前

 | 

操作员

 |
| --- | --- | --- | --- |
| one | ** | Ten | & |
| Two | ++ - | Eleven | ^ |
| three | ~ -(一元) | Twelve | &#124; |
| four | ！ | Thirteen | && |
| five | * / % | Fourteen | &#124;&#124; |
| six | + -(二进制) | Fifteen | = op= |
| seven | << >> | Sixteen | 和 |
| eight | < <= > >= <> | Seventeen | 异或运算 |
| nine | == != === !== <=> | Eighteen | 或者 |

举个例子，乘法的优先级高于加法，因此在下面一行代码中首先计算乘法。

```php
$x = 4 + 3 * 2; // 10

```

圆括号可用于强制优先级。括号中的表达式在该语句中的其他表达式之前进行计算。

```php
$x = (4 + 3) * 2; // 14

```

## 附加逻辑运算符

在优先表中，特别注意最后三个运算符:`and`、`or`和`xor`。`and`和`or`运算符的工作方式与逻辑`&&`和`||`运算符相同。唯一的区别是它们的优先级较低。

```php
// Same as: $x = (true && false);
$x = true && false; // $x is false (0)

// Same as: ($x = true) and false;
$x = true and false; // $x is true (1)

```

`xor`运算符是位`^`运算符的布尔版本。如果只有一个操作数为真，则计算结果为`true`。

```php
$x = (true xor true); // false

```